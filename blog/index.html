---
layout: default
title: blog
pagination:
  enabled: true
paginate: 10                      # posts per page
paginate_path: "/blog/page:num/"  # URLs like /blog/page2/
---

{% assign posts = paginator.posts %}

{% assign pinned    = posts | where_exp: "i", "i.pinned != nil" | where_exp: "i", "i.pinned >= 0" %}
{% assign unpinned1 = posts | where_exp: "i", "i.pinned == nil" %}
{% assign unpinned2 = posts | where_exp: "i", "i.pinned < 0" %}
{% assign unpinned  = unpinned1 | concat: unpinned2 %}

{% assign priorities = pinned | map: "pinned" | uniq | sort %}

{% for prio in priorities %}
  {% assign bucket = pinned | where: "pinned", prio | sort: "date" | reverse %}
  {% for it in bucket %}
    {% include item-preview.html item=it %}
  {% endfor %}
{% endfor %}


{% assign others_sorted = unpinned | sort: "date" | reverse %}
{% for it in others_sorted %}
  {% include item-preview.html item=it %}
{% endfor %}


<nav class="pagination">
  {% if paginator.previous_page %}
    {% if paginator.previous_page == 1 %}
      <a href="{{ '/blog/' | relative_url }}">← Newer</a>
    {% else %}
      <a href="{{ '/blog/page' | append: paginator.previous_page | append: '/' | relative_url }}">← Newer</a>
    {% endif %}
  {% endif %}
  <span>Page {{ paginator.page }} of {{ paginator.total_pages }}</span>
  {% if paginator.next_page %}
    <a href="{{ '/blog/page' | append: paginator.next_page | append: '/' | relative_url }}">Older →</a>
  {% endif %}
</nav>
